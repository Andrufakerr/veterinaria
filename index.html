<!DOCTYPE html>
<html lang="es">
<head>
  <link rel="icon" type="image/x-icon" href="imagenes/icono.ico">
  <meta charset="UTF-8">
  <title>Turnos Veterinaria</title>
<style>
/* === RESETEO GENERAL === */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  scroll-behavior: smooth;
  font-size: 16px;
}

body {
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #6a00b6, #9500ff, #e969cb);
  color: #333;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  padding: 20px;
}

/* === CONTENEDOR PRINCIPAL === */
.info-vet {
  background: white;
  width: 100%;
  max-width: 600px;
  padding: 40px 30px;
  border-radius: 20px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  animation: fadeIn 0.6s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

.info-vet img {
  width: 100%;
  max-width: 240px;
  height: auto;
  margin-bottom: 10px;
}

.info-vet h1 {
  color: #6a00b6;
  font-size: clamp(1.6rem, 5vw, 2.3rem);
  line-height: 1.2;
}

.info-vet p {
  font-size: clamp(1rem, 4vw, 1.3rem);
  margin-bottom: 6px;
}

/* === BOTÓN DE TURNOS FIJO === */
.btn-turno {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: linear-gradient(135deg, #6a00b6, #9500ff);
  color: white;
  padding: 14px 28px; /* 🔹 más chico en PC */
  font-size: 1.1rem;
  border-radius: 40px;
  text-decoration: none;
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  transition: transform 0.25s ease, box-shadow 0.25s ease, background 0.25s ease;
  z-index: 2000;
}


/* === WHATSAPP === */
.whatsapp-line {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  margin: 12px 0;
  flex-wrap: wrap;
}

.whatsapp-line img {
  width: 28px;
  height: 28px;
}

.whatsapp-line strong {
  font-size: clamp(1.1rem, 4vw, 1.3rem);
  color: #333;
}

.whatsapp-number a {
  color: #128C7E;
  font-weight: bold;
  font-size: clamp(1.2rem, 4.5vw, 1.4rem);
  text-decoration: none;
  transition: transform 0.2s ease;
}

.whatsapp-number a:hover {
  transform: scale(1.05);
}

/* === MAPA === */
iframe {
  width: 100%;
  height: 250px;
  border: none;
  border-radius: 12px;
  margin-top: 10px;
}

/* === MODAL === */
.modal {
  display: none;
  position: fixed;
  inset: 0;
  background-color: rgba(0,0,0,0.55);
  align-items: center;
  justify-content: center;
  z-index: 3000;
}

.modal.active {
  display: flex;
}

.editorcaja {
  background: white;
  width: 95%;
  max-width: 750px;
  border-radius: 20px;
  padding: 25px;
  box-shadow: 0 6px 25px rgba(0,0,0,0.3);
  overflow-y: auto;
  max-height: 90vh;
  animation: slideUp 0.4s ease;
}

.editorcaja h3 {
  color: #6a00b6;
  font-size: clamp(1.4rem, 5vw, 1.8rem);
  text-align: center;
  margin-bottom: 20px;
}

form label {
  display: block;
  margin-top: 10px;
  font-weight: bold;
  font-size: clamp(1rem, 4vw, 1.2rem);
}

form input,
form select,
form textarea {
  width: 100%;
  padding: 12px;
  margin-top: 5px;
  border: 1px solid #ccc;
  border-radius: 10px;
  font-size: clamp(1rem, 4vw, 1.2rem);
}

form textarea {
  resize: none;
}

button {
  border: none;
  cursor: pointer;
}

.btn-primary {
  background: #6a00b6;
  color: white;
  padding: 12px 20px;
  border-radius: 10px;
  font-size: clamp(1rem, 4vw, 1.2rem);
}

.btn {
  background: #ccc;
  color: #333;
  padding: 12px 20px;
  border-radius: 10px;
  font-size: clamp(1rem, 4vw, 1.2rem);
}

.actions-row {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 15px;
}

/* === ANIMACIONES === */
@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes slideUp {
  from { transform: translateY(40px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

/* === MÓVILES GRANDES Y PEQUEÑOS === */
/* === MÓVILES GRANDES Y PEQUEÑOS === */
@media (max-width: 1000px) {
  html { font-size: 22px; } /* 🔹 texto base más grande */
  body { padding: 8px; }

  .info-vet {
    padding: 40px 22px;
    width: 100%;
    max-width: 100%;
  }

  .info-vet h1 {
    font-size: 2.5rem;
  }

  .info-vet p {
    font-size: 1.6rem;
  }

  .whatsapp-line strong,
  .whatsapp-number a {
    font-size: 1.7rem;
  }

  iframe {
    height: 340px;
  }

  /* 🔹 Botón GIGANTE en celular */
  .btn-turno {
    padding: 34px 70px;
    font-size: 2.4rem;
    border-radius: 28px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.4);
  }

  /* 🔹 Modal del mismo tamaño que .info-vet */
  .editorcaja {
    width: 100%;
    max-width: 100%;
    height: auto;
    max-height: 95vh;
    padding: 40px 25px;
    border-radius: 24px;
    font-size: 1.4rem;
    box-shadow: 0 8px 25px rgba(0,0,0,0.4);
  }

  .editorcaja h3 {
    font-size: 2.2rem;
    margin-bottom: 25px;
  }

  form label,
  form input,
  form select,
  form textarea,
  .btn-primary,
  .btn {
    font-size: 1.5rem;
  }

  .actions-row {
    gap: 16px;
  }
}



</style>
  <!-- === META OPEN GRAPH PARA WHATSAPP, FACEBOOK, ETC === -->
<meta property="og:title" content="El Chico de los Perros 🐾">
<meta property="og:description" content="Peluquería Canina y Gatuna • Turnos online • Atención de Martes a Domingo de 15:00 a 22:00.">
<meta property="og:image" content="https://andrufakerr.github.io/veterinaria/imagenes/logo.png">
<meta property="og:url" content="https://andrufakerr.github.io/veterinaria/">
<meta property="og:type" content="website">

<!-- === META PARA TWITTER (opcional, también usado por WhatsApp a veces) === -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="El Chico de los Perros 🐾">
<meta name="twitter:description" content="Peluquería Canina y Gatuna • Turnos online • Atención de Martes a Domingo de 15:00 a 22:00.">
<meta name="twitter:image" content="https://andrufakerr.github.io/veterinaria/imagenes/logo.png">

</head>
<body>

   
  <section class="info-vet">
   <img src="imagenes/logo.png"> 


    <h1>El chico de los Perros </h1>
    <h1>Peluqueria Canina y Gatuna</h1>
    <p><strong>Horario:</strong> Martes a Domingo</p>
    <p><strong></strong> Abierto de 15:00 a 22:00</p>
<div class="whatsapp-section">
  <div class="whatsapp-line">
    <img src="imagenes/wsp.png" alt="WhatsApp">
    <strong>Número de WhatsApp</strong>
  
  <div class="whatsapp-number">
    <a href="https://wa.me/543804928424" target="_blank">3804928424</a>
 
</div>
</div>
<h2 style="margin-top:25px;">📍 Cómo llegar</h2>
    <iframe 
      src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1315.5665200867988!2d-66.8678786!3d-29.424839!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2z!5e0!3m2!1ses!2sar!4v1729824000000!5m2!1ses!2sar" 
      loading="lazy" 
      allowfullscreen 
      referrerpolicy="no-referrer-when-downgrade">
    </iframe>
    <p><a href="https://maps.app.goo.gl/hGoaXSNzVjrxVRDT8?g_st=aw" target="_blank"></a></p>
  

    <a href="#" id="btnNuevoTurno" class="btn-turno">📅 Solicitar Turno</a>

  </section>

  <!-- 🔵 MODAL NUEVO TURNO -->
  <div id="modalTurno" class="modal">
    <div class="editorcaja">
      <h3>Nuevo Turno</h3>
      <form id="formTurno" class="scroll-form">
        <label>Nombre del Dueño:</label>
        <input type="text" id="dueño" required>

        <label>Nombre del Perro:</label>
        <input type="text" id="perro" required>

        <label>Teléfono:</label>
        <input type="text" id="telefono" required>

        <label>Servicio:</label>
        <select id="servicio" required>
          <option value="Todos">Todos</option>
          <option value="Deslanados">Deslanados</option>
          <option value="Baños sanitarios">Baños sanitarios</option>
          <option value="Corte de uñas">Corte de uñas</option>
          <option value="Peluquería general">Peluquería general</option>
        </select>


        <label>Fecha del Turno:</label>
        <input type="date" id="fecha" required>

        <label>Horario:</label>
        <select id="hora" required>
          <option value="">Seleccionar una Fecha</option>
          <option value="15:00">15:00</option>
          <option value="16:30">16:30</option>
          <option value="18:30">18:30</option>
        </select>

        <div class="actions-row" style="margin-top:10px;">
  <button type="submit" class="btn-primary">Guardar</button>
  <button type="button" id="btnCancelar" class="btn">Cancelar</button>
</div>

      </form>
    </div>
  </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- 🟨 Firebase -->
  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-app.js";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/11.0.0/firebase-database.js";
  let datosTurnoActual = null;

  // === CONFIGURACIÓN FIREBASE ===
  const firebaseConfig = {
    apiKey: "AIzaSyBu8D-puwW2E5pkKsXOKYjsQr_UnqhGrqw",
    authDomain: "veterinaria-28331.firebaseapp.com",
    projectId: "veterinaria-28331",
    storageBucket: "veterinaria-28331.firebasestorage.app",
    messagingSenderId: "709696984659",
    appId: "1:709696984659:web:08e9f2008b4195f0eb58a6",
    databaseURL: "https://veterinaria-28331-default-rtdb.firebaseio.com"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // === REFERENCIAS HTML ===
  const modal = document.getElementById("modalTurno");
  const btnNuevoTurno = document.getElementById("btnNuevoTurno");
  const btnCancelar = document.getElementById("btnCancelar");
  const form = document.getElementById("formTurno");
  const fechaInput = document.getElementById("fecha");
  const horaSelect = document.getElementById("hora");

  // === ABRIR / CERRAR MODAL ===
  btnNuevoTurno.onclick = () => modal.classList.add("active");
  btnCancelar.onclick = () => modal.classList.remove("active");
  window.onclick = e => { if (e.target === modal) modal.classList.remove("active"); };

  // === REGLA 1: FECHA MÁXIMA = HOY + 3 SEMANAS ===
  const hoy = new Date();
  const maxFecha = new Date();
  maxFecha.setDate(hoy.getDate() + 21); // 3 semanas

  fechaInput.min = hoy.toISOString().split("T")[0];
  fechaInput.max = maxFecha.toISOString().split("T")[0];
  // === REGLA 5: NO PERMITIR LUNES ===
fechaInput.addEventListener("input", () => {
  const fecha = new Date(fechaInput.value + "T00:00:00");
  const diaSemana = fecha.getDay(); // 0=Dom, 1=Lun, 2=Mar, ...
  
  if (diaSemana === 1) { // Lunes
    alert("⚠️ No se pueden reservar turnos los lunes. Elegí otro día (Martes a Domingo).");
    fechaInput.value = ""; // Limpiar selección
  }
});

  // === REGLA 4: HORARIOS DEPENDEN DE LA FECHA ===
  horaSelect.disabled = true;

  fechaInput.addEventListener("change", () => {
    const fechaElegida = fechaInput.value;
    horaSelect.innerHTML = '<option value="">Seleccionar...</option>';
    horaSelect.disabled = true;

    if (!fechaElegida) return;

    const refTurnos = ref(db, "turnos");
    onValue(refTurnos, snapshot => {
      const ocupados = [];
      snapshot.forEach(child => {
        const t = child.val();
        if (t.fecha === fechaElegida) ocupados.push(t.hora);
      });

      const horarios = ["15:00", "16:30", "18:30"];
      const disponibles = horarios.filter(h => !ocupados.includes(h));

      if (disponibles.length === 0) {
        alert("⚠️ Todos los horarios están ocupados para esta fecha.");
        fechaInput.value = "";
        return;
      }

      disponibles.forEach(h => {
        const opt = document.createElement("option");
        opt.value = h;
        opt.textContent = h;
        horaSelect.appendChild(opt);
      });

      horaSelect.disabled = false;
    }, { onlyOnce: true });
  });

  // === GUARDAR TURNO ===
  form.addEventListener("submit", e => {
    e.preventDefault();

    const dueño = document.getElementById("dueño").value.trim();
    const perro = document.getElementById("perro").value.trim();
    const telefono = document.getElementById("telefono").value.trim();
    const servicio = document.getElementById("servicio").value;
    const tipo_pago = "No definido";
    const fecha = fechaInput.value;
    const hora = horaSelect.value;

    if (!dueño || !perro || !telefono || !servicio || !fecha || !hora) {
      alert("⚠️ Completa todos los campos obligatorios.");
      return;
    }

    // === REGLA 2: VALIDAR ANTICIPACIÓN DE 6 HORAS ===
    const [horaH, horaM] = hora.split(":").map(Number);
    const fechaTurno = new Date(`${fecha}T${horaH.toString().padStart(2, "0")}:${horaM.toString().padStart(2, "0")}:00`);

    // Convertir a hora local de Buenos Aires (UTC-3)
    const ahora = new Date();
    const offsetBuenosAires = -3 * 60; // minutos
    const offsetLocal = ahora.getTimezoneOffset();
    const diferencia = (offsetBuenosAires - offsetLocal) * 60 * 1000;
    const ahoraBuenosAires = new Date(ahora.getTime() + diferencia);

    const diffHoras = (fechaTurno - ahoraBuenosAires) / (1000 * 60 * 60);
    if (diffHoras < 6) {
      alert("⚠️ El turno debe reservarse con al menos 6 horas de anticipación.");
      return;
    }

    // === REGLA 3: NO DUPLICAR ===
    const refTurnos = ref(db, "turnos");
    let duplicado = false;

    onValue(refTurnos, snapshot => {
      snapshot.forEach(child => {
        const t = child.val();
        if (t.fecha === fecha && t.hora === hora) duplicado = true;
      });
    }, { onlyOnce: true });

    setTimeout(() => {
      if (duplicado) {
        alert("⚠️ Ese horario ya está ocupado.");
      } else {
       push(ref(db, "turnos"), { dueño, perro, telefono, servicio, tipo_pago, fecha, hora });
       datosTurnoActual = { dueño, perro, telefono, servicio, fecha, hora };
push(ref(db, "turnos"), { ...datosTurnoActual, tipo_pago });
form.reset();
horaSelect.disabled = true;
modal.classList.remove("active");
       form.reset();
horaSelect.disabled = true;
modal.classList.remove("active");

// Mostrar modal de confirmación
const modalConfirm = document.getElementById("modalConfirmacion");
modalConfirm.classList.add("active");

// Configurar botones
document.getElementById("btnOtroTurno").onclick = () => {
  modalConfirm.classList.remove("active");
  modal.classList.add("active");
};



      }
    }, 400);
  });
  document.getElementById("btnImprimir").onclick = async () => {
  generarPDF(); // 🔹 llamamos a tu función más completa
};


// 🔸 Pegar aquí la función generarPDF
const generarPDF = () => {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const ancho = doc.internal.pageSize.getWidth();
  const alto = doc.internal.pageSize.getHeight();

  // ==== CUADRO MORADO ====
  doc.setDrawColor(128, 0, 128);
  doc.setLineWidth(2);
  doc.rect(10, 10, ancho - 20, alto - 20);

  const logo = new Image();
  logo.src = "imagenes/logo.png";

  logo.onload = function () {
    // ==== LOGO ====
    doc.addImage(logo, "PNG", ancho / 2 - 15, 15, 30, 30);

    // ==== TÍTULO CENTRADO ====
    doc.setTextColor(128, 0, 128);
    doc.setFontSize(20);
    doc.text("Turno: El Chico de los Perros", ancho / 2, 60, { align: "center" });

    // ==== DATOS ====
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(14);

    const t = datosTurnoActual || {
      dueño: document.getElementById("dueño").value.trim(),
      perro: document.getElementById("perro").value.trim(),
      telefono: document.getElementById("telefono").value.trim(),
      servicio: document.getElementById("servicio").value,
      fecha: document.getElementById("fecha").value,
      hora: document.getElementById("hora").value,
    };

    // ==== FECHA FORMATO ARG ====
    let fechaFormateada = "";
    if (t.fecha) {
      const [año, mes, dia] = t.fecha.split("-");
      fechaFormateada = `${dia}/${mes}/${año}`;
    }

    // ==== SIN TELÉFONO ====
    const datos = [
      ["Dueño:", t.dueño],
      ["Mascota:", t.perro],
      ["Servicio:", t.servicio],
      ["Fecha:", fechaFormateada],
      ["Hora:", t.hora],
    ];

    let y = 85;
    datos.forEach(([titulo, valor]) => {
      doc.setFont("helvetica", "bold");   // 🔹 título en negrita
      doc.text(titulo, 20, y);

      doc.setFont("helvetica", "normal"); // 🔹 contenido normal
      doc.text(valor, 55, y); // el valor un poco más a la derecha
      y += 12;
    });

    // ==== PIE DE PÁGINA ====
    doc.setFontSize(16);
    doc.setFont("helvetica", "normal");
    doc.setTextColor(128);
    doc.text("Ante cualquier duda contactar al: 3804928424", 20, alto - 20);

    // ==== GUARDAR ====
    doc.save(`Turno_${t.perro}_${t.fecha}.pdf`);
  };
};




</script>



<!-- ✅ MODAL DE CONFIRMACIÓN -->
<div id="modalConfirmacion" class="modal">
  <div class="editorcaja" style="text-align:center;">
    <h3 style="color:#6a00b6;">✅ Turno Agendado Correctamente</h3>
    <p>Tu turno fue registrado con éxito.</p>
    <div style="margin-top:20px;">
      <button id="btnOtroTurno" class="btn-primary">Agendar otro Turno</button>
      <button id="btnImprimir" class="btn">Imprimir PDF</button>
    </div>
  </div>
</div>
</body>
</html>
